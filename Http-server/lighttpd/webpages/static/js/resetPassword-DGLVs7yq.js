var y=(_,g,e)=>new Promise((w,p)=>{var o=a=>{try{i(e.next(a))}catch(d){p(d)}},m=a=>{try{i(e.throw(a))}catch(d){p(d)}},i=a=>a.done?w(a.value):Promise.resolve(a.value).then(o,m);i((e=e.apply(_,g)).next())});import{d as C,k as h,r as R,i as N,j as S,a as f,o as q,c as B,b as T,t as v,u as n,f as l,w as r,e as k,E as P,a5 as U,b6 as E,_ as I}from"./index-B378b16y.js";import{c as M}from"./rule-Dak8crAi.js";const $={class:"form-container"},j={class:"form-title"},D=C({name:"ResetPassward",__name:"resetPassword",props:{username:{type:String,default:""}},setup(_){const g=_,e=h({oldPwd:null,newPwd1:null,newPwd2:null}),w=R(!1),p=N(),{t:o}=S(),m=R(),i=()=>y(this,null,function*(){try{w.value=!0;const{code:u}=yield E({username:g.username,oldPassword:e.oldPwd,newPassword:e.newPwd1});+u==200?(P.success(o("login.changeSuccess")),setTimeout(()=>{d()},2e3)):P.error(o("request.error"))}catch(u){P.error(o("request.error"))}finally{w.value=!1}}),a=u=>{u&&u.validate(s=>{s&&(e.newPwd1&&e.newPwd1!==e.newPwd2&&P.error(o("login.newPasswordRuleReg")),i())})},d=()=>{p.push(U().path)};return(u,s)=>{const b=f("el-input"),c=f("el-form-item"),V=f("el-button"),x=f("el-form");return q(),B("div",$,[T("p",j,v(n(o)("login.change")),1),l(x,{ref_key:"formRef",ref:m,model:e,style:{"max-width":"50%"},rules:n(M),"label-position":"top"},{default:r(()=>[l(c,{prop:"oldPwd",label:n(o)("login.oldPassword"),rules:[{required:!0,message:n(o)("login.passwordReg"),trigger:"blur"}]},{default:r(()=>[l(b,{modelValue:e.oldPwd,"onUpdate:modelValue":s[0]||(s[0]=t=>e.oldPwd=t)},null,8,["modelValue"])]),_:1},8,["label","rules"]),l(c,{label:n(o)("login.newPassword"),prop:"newPwd1"},{default:r(()=>[l(b,{modelValue:e.newPwd1,"onUpdate:modelValue":s[1]||(s[1]=t=>e.newPwd1=t),type:"password","show-password":""},null,8,["modelValue"])]),_:1},8,["label"]),l(c,{label:n(o)("login.confirmNewPassword"),prop:"newPwd2"},{default:r(()=>[l(b,{modelValue:e.newPwd2,"onUpdate:modelValue":s[2]||(s[2]=t=>e.newPwd2=t),type:"password","show-password":""},null,8,["modelValue"])]),_:1},8,["label"]),l(c,null,{default:r(()=>[l(V,{loading:w.value,type:"primary",onClick:s[3]||(s[3]=t=>a(m.value))},{default:r(()=>[k(v(n(o)("buttons.hssave")),1)]),_:1},8,["loading"]),l(V,{onClick:s[4]||(s[4]=t=>d())},{default:r(()=>[k(v(n(o)("buttons.hscancel")),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])])}}}),G=I(D,[["__scopeId","data-v-bfb8ab0d"]]);export{G as default};
