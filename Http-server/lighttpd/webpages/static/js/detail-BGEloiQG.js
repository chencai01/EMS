var M=(p,d,x)=>new Promise((C,h)=>{var a=r=>{try{v(x.next(r))}catch(P){h(P)}},V=r=>{try{v(x.throw(r))}catch(P){h(P)}},v=r=>r.done?C(r.value):Promise.resolve(r.value).then(a,V);v((x=x.apply(p,d)).next())});import{d as K,j as Q,i as W,r as g,l as X,G as Y,a as b,o as _,c as T,f as Z,u as c,b as t,m as y,y as I,w as R,F as D,n as ee,t as m,s as w,B as te,C as oe,_ as le}from"./index-B378b16y.js";import{B as ne}from"./index-TOYUMokL.js";import{r as se,a as ae,b as ce}from"./pack-rCzq7zF4.js";import{u as o}from"./pack-CNPb50Bb.js";import{v as N}from"./valueUtil-BReNmlgC.js";import{u as ie}from"./useTimer-u5e-KjxW.js";import"./index-CbvsTRMa.js";import"./cluster-DKWQwuWS.js";import"./WarningsUtil-CTO3mp7U.js";import"./meter-nf4_0FAI.js";import"./ac-Dv1xUiln.js";const A=p=>(te("data-v-779699f9"),p=p(),oe(),p),de={class:"page-container"},re={class:"detail-container"},ue={key:1,class:"flex-[260]"},me={class:"flex flex-1 justify-center w-full"},fe={class:"detail-item"},ve={class:"detail-item-voltage"},_e={class:"detail-item-voltage-content",style:{"border-right":"1px solid #e5e8ef","border-bottom":"1px solid #e5e8ef"}},pe={class:"detail-item-voltage-content-num"},xe={class:"info-item-content"},Ce={class:"info-item-info"},he={class:"info-item-info-label"},Ve={class:"info-item-info-value-container"},Pe=A(()=>t("span",{class:"info-item-info-unit"},"V",-1)),ge={class:"detail-item-voltage-content",style:{"border-bottom":"1px solid #e5e8ef"}},Se={class:"detail-item-voltage-content-num"},Me={class:"info-item-content"},Te={class:"info-item-info"},Ie={class:"info-item-info-label"},ke={class:"info-item-info-value-container"},be=A(()=>t("span",{class:"info-item-info-unit"},"V",-1)),ye={class:"detail-item-temperature"},we={class:"detail-item-temperature-NTC"},Ne={class:"info-item-content"},Ae={class:"info-item-info"},Be={class:"info-item-info-label"},qe={class:"info-item-info-value-container"},Re=A(()=>t("span",{class:"info-item-info-unit"},"℃",-1)),je={key:3,class:"flex-[260]"},j=0,Le=-40,Fe=K({name:"PackDetail",__name:"detail",setup(p){const{t:d}=Q(),x=W(),C=g([]),h=g([]),a=g([]),V=g([]),v=g(""),r=()=>M(this,null,function*(){try{const l=yield se(o().stackSelectedValue,o().clusterSelectedValue);l.code==200?(C.value.length=0,C.value=l.data.cellVolt):console.warn("--[pack] requestAllPackCellVolt invalid code",l.code);const n=yield ae(o().stackSelectedValue,o().clusterSelectedValue);n.code==200?(h.value.length=0,h.value=n.data.cellTemp):console.warn("--[pack] requestAllPackCellTemp invalid code",n.code),P(o().packIndex)}catch(l){console.warn("--[pack] --requestAllPackInfo error:",l)}}),P=l=>{a.value.splice(0,C.value.length);const n=C.value[l-1],i=h.value[l-1],u=Math.max(...n),f=Math.min(...n),e=n.findIndex(s=>+s===u),z=n.findIndex(s=>+s===f),S=Math.max(...i),k=Math.min(...i),E=i.findIndex(s=>+s===S),G=i.findIndex(s=>+s===k);let q=1;for(let s=0;s<n.length;s+=2){const U=n[s],H=n[s+1],J=i[s/2];a.value.push({index:q,CellVoltNo1:u===f&&u===j?"--":+U,CellVoltNo2:u===f&&u===j?"--":+H,CellTemp:S===k&&S===Le?"--":+J,MaxCellVolt:u,MinCellVolt:f,MaxCellVoltPositon:e+1,MinCellVoltPositon:z+1,MaxCellTemp:S,MinCellTemp:k,MaxCellTempPosition:E+1,MinCellTempPosition:G+1}),q++}return a},B=()=>M(this,null,function*(){try{const l=yield ce(o().stackSelectedValue,o().clusterSelectedValue);l.code==200?V.value=l.data.ProductionSn:console.warn("--[meter] requestAllPackProductInfo invalid code",l.code),V.value&&V.value.length>0?v.value="SN："+V.value[o().packIndex-1]:v.value="SN：--"}catch(l){console.warn("--[meter] --requestAllPackProductionSn error:",l)}}),L={label:o().packIndex,value:o().packIndex},F={label:o().stackSelectedValue,value:o().stackSelectedValue},O={label:o().clusterSelectedValue,value:o().clusterSelectedValue},$=({stack:l,cluster:n,pack:i})=>{o().setPackIndex(i),o().setStackSelectedValue(l),o().setClusterSelectedValue(n)};return X([()=>o().stackSelectedValue,()=>o().clusterSelectedValue,()=>o().packIndex],(z,S)=>M(this,[z,S],function*([l,n,i],[u,f,e]){(l!==u||n!==f||i!==e)&&(r(),B())})),Y(()=>{B()}),ie(()=>{r()},{immediate:!0,immediateCallback:!0}),(l,n)=>{const i=b("el-empty"),u=b("el-col"),f=b("el-row");return _(),T("div",de,[Z(ne,{"default-stack":F,"default-cluster":O,"default-pack":L,extraText:v.value,rightList:[{label:c(d)("pack.cell"),value:a.value.length*2+"",unit:c(d)("pack.num")},{label:c(d)("pack.temp"),value:a.value.length+"",unit:c(d)("pack.num")}],onOnChange:$,onOnBackClicked:n[0]||(n[0]=e=>c(x).push("/deviceControl/pack"))},null,8,["extraText","rightList"]),t("div",re,[a.value.length===0?(_(),y(i,{key:0,description:c(d)("common.noData")},null,8,["description"])):I("",!0),a.value.length>0?(_(),T("div",ue)):I("",!0),a.value.length>0?(_(),y(f,{key:2,class:"flex justify-center flex-[590]",style:{"max-width":"830px"}},{default:R(()=>[(_(!0),T(D,null,ee(a.value,e=>(_(),y(u,{key:e.index,class:"detail-item-container",xs:12,sm:12,md:12,lg:12,xl:12},{default:R(()=>[t("div",me,[t("div",fe,[t("div",ve,[t("div",_e,[t("span",pe,m(e.index+(e.index-1)),1),t("div",xe,[t("div",Ce,[t("span",he,m(c(d)("common.voltage")),1),t("span",Ve,[t("span",{class:w(["info-item-info-value",{"info-value-maxvoltage":2*e.index-1===e.MaxCellVoltPositon&&e.MaxCellVolt!==e.MinCellVolt,"info-value-minvoltage":2*e.index-1===e.MinCellVoltPositon&&e.MaxCellVolt!==e.MinCellVolt}])},m(c(N).roundString(e.CellVoltNo1,3)),3),Pe])])])]),t("div",ge,[t("span",Se,m(e.index*2),1),t("div",Me,[t("div",Te,[t("span",Ie,m(c(d)("common.voltage")),1),t("span",ke,[t("span",{class:w(["info-item-info-value",{"info-value-maxvoltage":e.index*2===e.MaxCellVoltPositon&&e.MaxCellVolt!==e.MinCellVolt,"info-value-minvoltage":e.index*2===e.MinCellVoltPositon&&e.MaxCellVolt!==e.MinCellVolt}])},m(c(N).roundString(e.CellVoltNo2,3)),3),be])])])])]),t("div",ye,[t("span",we," NTC:"+m(e.index),1),t("div",Ne,[t("div",Ae,[t("span",Be,m(c(d)("home.temp")),1),t("span",qe,[t("span",{class:w(["info-item-info-value",{"info-value-maxtemp":e.index===e.MaxCellTempPosition&&e.MaxCellTemp!==e.MinCellTemp,"info-value-mintemp":e.index===e.MinCellTempPosition&&e.MaxCellTemp!==e.MinCellTemp}])},m(c(N).roundString(e.CellTemp,1)),3),Re])])])])])])]),_:2},1024))),128))]),_:1})):I("",!0),a.value.length>0?(_(),T("div",je)):I("",!0)])])}}}),Ye=le(Fe,[["__scopeId","data-v-779699f9"]]);export{Ye as default};
