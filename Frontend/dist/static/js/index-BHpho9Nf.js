var C=(x,w,t)=>new Promise((h,c)=>{var p=n=>{try{v(t.next(n))}catch(o){c(o)}},_=n=>{try{v(t.throw(n))}catch(o){c(o)}},v=n=>n.done?h(n.value):Promise.resolve(n.value).then(p,_);v((t=t.apply(x,w)).next())});import{o as b,c as V,g as q,d as D,i as F,j as O,r as E,k as B,l as G,a as f,m as S,w as i,b as s,f as l,n as I,F as U,e as y,t as d,u as e,p as j,q as z,E as M,s as g,_ as L}from"./index-B378b16y.js";import{P as W}from"./pcs-B1iYHllG.js";import H from"./index-CAZyMmeb.js";import{_ as J}from"./PCSSettings.vue_vue_type_style_index_0_lang-BaWvo-F8.js";import{u as K}from"./useTimer-u5e-KjxW.js";import{v as u}from"./valueUtil-BReNmlgC.js";import{I as m}from"./index-CGgGq9hQ.js";import"./WarningsUtil-CTO3mp7U.js";import"./icon-settings-B7co2eUu.js";import"./icon-power-off-DaFr1WKX.js";import"./icontype-CrdMeA1p.js";import"./comInterrupt-0m6mzMWM.js";const Q={xmlns:"http://www.w3.org/2000/svg",width:"88",height:"92"},X=q('<defs><linearGradient id="a" x1="50%" x2="50%" y1="42.96%" y2="100%"><stop offset="0%" stop-color="#1E3EA2"></stop><stop offset="100%" stop-color="#1E3EA2" stop-opacity="0"></stop></linearGradient><linearGradient id="b" x1="50%" x2="50%" y1="42.96%" y2="100%"><stop offset="0%" stop-color="#1E3EA2"></stop><stop offset="100%" stop-color="#1E3EA2" stop-opacity="0"></stop></linearGradient></defs><g fill="none" fill-rule="evenodd"><path stroke="url(#a)" d="M68 1.5c.966 0 1.841.392 2.475 1.025A3.5 3.5 0 0 1 71.5 5v85.5h-55V5c0-.966.392-1.841 1.025-2.475A3.5 3.5 0 0 1 20 1.5Z"></path><path stroke="url(#b)" d="M71 1.5c.966 0 1.841.392 2.475 1.025A3.5 3.5 0 0 1 74.5 5v82c0 .966-.392 1.841-1.025 2.475A3.5 3.5 0 0 1 71 90.5H17a3.5 3.5 0 0 1-2.475-1.025A3.5 3.5 0 0 1 13.5 87V5c0-.966.392-1.841 1.025-2.475A3.5 3.5 0 0 1 17 1.5Z"></path><path fill="#1E3EA2" fill-opacity=".2" d="M32.5 86h23a.5.5 0 1 1 0 1h-23a.5.5 0 1 1 0-1"></path><path fill="#1E3EA2" fill-opacity=".1" d="M17 7h54a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1H17a1 1 0 0 1-1-1V8a1 1 0 0 1 1-1"></path><path fill="#1E3EA2" d="M32.5 71h23a.5.5 0 1 1 0 1h-23a.5.5 0 1 1 0-1M32.5 74h23a.5.5 0 1 1 0 1h-23a.5.5 0 1 1 0-1"></path><path fill="#1E3EA2" fill-opacity=".8" d="M32.5 77h23a.5.5 0 1 1 0 1h-23a.5.5 0 1 1 0-1"></path><path fill="#1E3EA2" fill-opacity=".6" d="M32.5 80h23a.5.5 0 1 1 0 1h-23a.5.5 0 1 1 0-1"></path><path fill="#1E3EA2" fill-opacity=".4" d="M32.5 83h23a.5.5 0 1 1 0 1h-23a.5.5 0 1 1 0-1"></path><path stroke="#1E3EA2" d="M55.5 23.5v17h-23v-17zM21.5 46.5v17h-2v-17z"></path><path fill="#1E3EA2" fill-opacity=".1" stroke="#1E3EA2" d="M52.5 26.5v11h-17v-11z"></path><path stroke="#1E3EA2" d="M34 15.5c.414 0 .79.168 1.06.44a1.495 1.495 0 0 1 0 2.121c-.27.271-.646.439-1.06.439s-.79-.168-1.06-.44A1.5 1.5 0 0 1 32.5 17c0-.414.168-.79.44-1.06.27-.272.646-.44 1.06-.44ZM44 15.5c.414 0 .79.168 1.06.44a1.495 1.495 0 0 1 0 2.121c-.27.271-.646.439-1.06.439s-.79-.168-1.06-.44A1.5 1.5 0 0 1 42.5 17c0-.414.168-.79.44-1.06.27-.272.646-.44 1.06-.44ZM44 47.5c.69 0 1.315.28 1.768.732.452.453.732 1.078.732 1.768s-.28 1.315-.732 1.768A2.5 2.5 0 0 1 44 52.5c-.69 0-1.315-.28-1.768-.732A2.5 2.5 0 0 1 41.5 50c0-.69.28-1.315.732-1.768A2.5 2.5 0 0 1 44 47.5Z"></path><path stroke="#1E3EA2" stroke-opacity=".4" d="M44 45.5c1.243 0 2.368.504 3.182 1.318A4.49 4.49 0 0 1 48.5 50a4.49 4.49 0 0 1-1.318 3.182A4.49 4.49 0 0 1 44 54.5a4.49 4.49 0 0 1-3.182-1.318A4.49 4.49 0 0 1 39.5 50c0-1.243.504-2.368 1.318-3.182A4.49 4.49 0 0 1 44 45.5Z"></path><path stroke="#1E3EA2" d="M54 15.5c.414 0 .79.168 1.06.44a1.495 1.495 0 0 1 0 2.121c-.27.271-.646.439-1.06.439s-.79-.168-1.06-.44A1.5 1.5 0 0 1 52.5 17c0-.414.168-.79.44-1.06.27-.272.646-.44 1.06-.44Z"></path></g>',2),Y=[X];function ee(x,w){return b(),V("svg",Q,[...Y])}const te={render:ee},ae={class:"page-container"},oe={class:"grid-container"},se=["onClick"],le={class:"grid-item-header"},re={class:"inline-block"},ne={class:"flex flex-1 w-full"},ie={class:"flex flex-col flex-[168] justify-end items-center pb-[71px] min-w-[168px] h-full"},ce={class:"grid-item-content"},de={class:"flex justify-between w-full"},ue={class:"flex justify-between w-full mt-[16px]"},pe={class:"flex items-center w-full mt-[16px] mb-[44px]"},fe={class:"grid-item-communication-container"},me={class:"dialog-footer"},_e=D({name:"PCSList",__name:"index",setup(x){const w=F(),{t}=O(),h=E([]),c=E(!1),p=E(!1),_=B({password:""});G(()=>c.value,()=>{});const v=()=>{j({username:z().username,password:_.password}).then(o=>{+o.code==200?(p.value=!1,c.value=!0):M.error(t("pcs.confirmError"))}).catch(o=>{M.error(t("pcs.confirmError"))})},n=()=>C(this,null,function*(){if(!c.value)try{const o=yield W.requestAllPCSList();(o==null?void 0:o.code)==200?JSON.stringify(o.data)!=JSON.stringify(h.value)&&(h.value=o.data.pcsCard):console.warn("--[pcs] request invalid code",o==null?void 0:o.code)}catch(o){console.warn("--[pcs] request error",o==null?void 0:o.message)}});return K(()=>n(),{immediate:!0,immediateCallback:!0}),(o,r)=>{const P=f("el-col"),R=f("el-row"),T=f("el-input"),$=f("el-form-item"),N=f("el-form"),k=f("el-button"),Z=f("el-dialog");return b(),S(H,{"active-name":"pcs",onOnSettingClick:r[4]||(r[4]=a=>p.value=!0)},{default:i(()=>[s("div",ae,[s("div",oe,[l(R,{type:"flex",class:"flex-wrap",gutter:16},{default:i(()=>[(b(!0),V(U,null,I(h.value,(a,A)=>(b(),S(P,{key:A,class:"grid-item-container",xs:12,sm:12,md:12,lg:12,xl:12},{default:i(()=>[s("div",{class:g(["grid-item cursor-pointer",{comOff:!a.TimeoutFlag}]),onClick:he=>e(w).push({path:"/deviceControl/pcs/detail",query:{cabinet:1,pcs:A+1}})},[s("div",le,[s("span",{class:g(["grid-item-header-status-normal",{"grid-item-header-status-warning":a.fault_status==1},{"grid-item-header-status-fault":a.fault_status==2}])},d(a.fault_status==0?e(t)("common.normal"):a.fault_status==1?e(t)("common.warning"):e(t)("common.fault")),3),s("div",re,[y(d(e(t)("pcs.itemTitle",{cabinet:1,pcs:A+1}))+" ",1),s("span",null," （"+d(a.DC_status==0?e(t)("common.standby"):a.DC_status==1?e(t)("battery.charging"):e(t)("battery.discharging"))+"） ",1)]),s("span",{class:g(["grid-item-header-state-normal mr-[8px]",[{"grid-item-header-state-fault":a.grid_status==2}]])},d(a.grid_status==2?e(t)("pcs.offGridConnected"):e(t)("pcs.gridConnected")),3),s("span",{class:g(["grid-item-header-state-normal mr-[24px]",[{"grid-item-header-state-stop":a.onoff_status==0}]])},d(a.onoff_status==0?e(t)("pcs.stop"):e(t)("pcs.start")),3)]),s("div",ne,[s("div",ie,[l(e(te),{class:"w-[88px] h-[92px]"})]),s("div",ce,[s("div",de,[l(m,{class:"flex-1",label:e(t)("battery.acActivePower"),"value-unit":e(u).kWShortRoundString(a.total_active_power_of_AC_bus,1)},null,8,["label","value-unit"]),l(m,{class:"flex-1",label:e(t)("battery.acReactivePower"),"value-unit":e(u).kvarShortRoundString(a.total_reactive_power_of_AC_bus,1)},null,8,["label","value-unit"]),l(m,{class:"flex-1",label:e(t)("battery.dcPower"),"value-unit":e(u).kWShortRoundString(a.DC_power,1)},null,8,["label","value-unit"])]),s("div",ue,[l(m,{class:"flex-1",label:"SOC",value:e(u).isValid(a.soc)?e(u).roundString(a.soc,1)+"%":"--"},null,8,["value"]),l(m,{class:"flex-[2]",label:e(t)("battery.moduleTemperature"),value:e(u).roundString(a.module_temperature,1),unit:"℃"},null,8,["label","value"])]),s("div",pe,[l(m,{class:"flex-1",label:e(t)("battery.maximumRechargeablePower"),"value-unit":e(u).kWShortRoundString(a.max_chargeable_power,1)},null,8,["label","value-unit"]),l(m,{class:"flex-[2]",label:e(t)("battery.maximumDischargePower"),"value-unit":e(u).kWShortRoundString(a.max_dischargeable_power,1)},null,8,["label","value-unit"])])])]),s("div",fe,[s("div",{class:g(["grid-item-communication-status-normal",{" grid-item-communication-status-fault":!a.TimeoutFlag}])},d(e(t)(a.TimeoutFlag?"cluster.communicationNormal":"cluster.communicationBreak")),3)])],10,se)]),_:2},1024))),128))]),_:1})]),l(J,{modelValue:c.value,"onUpdate:modelValue":r[0]||(r[0]=a=>c.value=a)},null,8,["modelValue"]),l(Z,{modelValue:p.value,"onUpdate:modelValue":r[3]||(r[3]=a=>p.value=a),title:e(t)("pcs.confirmTitle"),width:"400"},{footer:i(()=>[s("span",me,[l(k,{onClick:r[2]||(r[2]=a=>p.value=!1)},{default:i(()=>[y(d(e(t)("pcs.cancel")),1)]),_:1}),l(k,{type:"primary",onClick:v},{default:i(()=>[y(d(e(t)("pcs.confirm")),1)]),_:1})])]),default:i(()=>[l(N,{model:_},{default:i(()=>[l($,{label:e(t)("login.password"),"label-width":"20%"},{default:i(()=>[l(T,{modelValue:_.password,"onUpdate:modelValue":r[1]||(r[1]=a=>_.password=a),autocomplete:"off",type:"password",placeholder:e(t)("login.passwordReg"),"show-password":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])]),_:1})}}}),Pe=L(_e,[["__scopeId","data-v-afddb53e"]]);export{Pe as default};
