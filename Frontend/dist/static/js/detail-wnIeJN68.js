var _=(k,l,s)=>new Promise((g,f)=>{var y=r=>{try{v(s.next(r))}catch(a){f(a)}},m=r=>{try{v(s.throw(r))}catch(a){f(a)}},v=r=>r.done?g(r.value):Promise.resolve(r.value).then(y,m);v((s=s.apply(k,l)).next())});import B from"./stackSvg-DeyaJ046.js";import{D as I}from"./index-D9CJN52I.js";import{I as n}from"./index-CGgGq9hQ.js";import{I as u}from"./icontype-CrdMeA1p.js";import{B as V}from"./index-TOYUMokL.js";import{d as $,j as N,K as j,i as E,v as O,r as S,x as U,D as F,G as M,H as P,o as R,c as A,b as o,f as t,u as e,e as p,t as d,_ as G}from"./index-B378b16y.js";import{e as C}from"./mitt-E5P-NQ8u.js";import{a as H}from"./stack-BZkaFHe6.js";import{u as q}from"./useTimer-u5e-KjxW.js";import"./box-NqioiwQx.js";import"./stackBattery.vue_vue_type_script_setup_true_lang-CE0KH4kZ.js";import"./index.vue_vue_type_script_setup_true_lang-60eETwKU.js";import"./index-C7yWB1xI.js";import"./hooks-DHRyCiWW.js";import"./arrow-right-bold-DCPknizU.js";import"./icon-power-off-DaFr1WKX.js";import"./comInterrupt-0m6mzMWM.js";import"./index-CbvsTRMa.js";import"./cluster-DKWQwuWS.js";import"./WarningsUtil-CTO3mp7U.js";import"./valueUtil-BReNmlgC.js";import"./pack-rCzq7zF4.js";import"./meter-nf4_0FAI.js";import"./ac-Dv1xUiln.js";const z={class:"top flex justify-between items-center h-[48px]"},K={class:"top-left flex items-center"},J={class:"top-right flex items-center"},L={class:"mr-[16px]"},Q={class:"content flex"},W={class:"content-left w-[46%] p-[16px]"},X={class:"status mb-[16px] flex flex-wrap"},Y={class:"status mb-[16px] flex flex-wrap"},Z={class:"charge flex mb-[20px]"},ee={class:"charge-content flex flex-1 justify-between bg-slate-100 mr-[20px]"},ae={class:"charge-content flex flex-1 justify-between bg-slate-100"},le={class:"content-right w-[54%] p-[16px]"},te={class:"charge flex"},se={class:"charge-content shadow flex bg-white mr-[20px]"},oe={class:"charge-content shadow flex bg-white"},ne=$({name:"StackDetail",__name:"detail",setup(k){const{t:l}=N(),{$f:s,$axiosCancel:g}=j(),f=E(),y=O(),{id:m}=y.params,v={label:+m,value:+m},r=S(),a=S({}),b=U(()=>{let i=0;for(let c=1;c<=4;c+=1)if((a.value[`Alarm${c}`]||0)>0){i=1;break}for(let c=1;c<=6;c+=1)if((a.value[`Fault${c}`]||0)>0){i=2;break}return i}),T=({cabinet:i,pcs:c,stack:h,cluster:x,pack:D})=>{},w=()=>{const i=document.querySelector(".svgGroup"),c=i.offsetHeight/451;i.style.transform=`scale(${c>1.3?1.3:c<.8?.8:c})`};return F(r,()=>{w()}),M(()=>_(this,null,function*(){C.on("everySecond",()=>{})})),q(()=>_(this,null,function*(){g(`/lcmain?type=bmsStackSummaryInfo&sn=${m}`);const i=yield H(m);i.code===200&&(a.value=i.data)}),{immediate:!0,immediateCallback:!0}),P(()=>{C.off("everySecond")}),(i,c)=>{var h,x;return R(),A("div",{ref_key:"stackDetailRef",ref:r,class:"device-detail"},[o("div",z,[o("div",K,[t(V,{"default-pack":!1,"default-cluster":!1,"default-stack":v,onOnChange:T,onOnBackClicked:c[0]||(c[0]=D=>e(f).push("/deviceControl/stack"))})]),o("div",J,[p(" PCS"),o("span",L,[p(" ("),o("span",null,d((h=a.value.PcsCurrentNum)!=null?h:0),1),p("/"+d((x=a.value.PcsTotalNum)!=null?x:0)+")",1)]),p(" "+d(e(l)("common.batteryCluster"))+" ",1),o("span",null,[p("("),o("span",null,d(a.value.BatteryClusterCurrentNum),1),p("/"+d(a.value.BatteryClusterTotalNum)+")",1)])])]),o("div",Q,[o("div",W,[o("div",X,[t(n,{class:"w-[33%] mb-[16px]",label:e(l)("common.faultStatus"),value:b.value===0?e(l)("common.normal"):b.value===1?e(l)("common.warning"):e(l)("common.fault"),iconType:b.value===0?e(u).noFault:b.value===1?e(u).warning:e(u).fault},null,8,["label","value","iconType"]),t(n,{class:"w-[33%] mb-[16px]",label:e(l)("common.workStatus"),value:e(l)(`common.${a.value.SystemState===0?"standstill":a.value.SystemState===1?"charge":"discharge"}`),iconType:a.value.SystemState===0?e(u).standstill:a.value.SystemState===1?e(u).charging:e(u).disCharging},null,8,["label","value","iconType"]),t(n,{class:"w-[33%] mb-[16px]",label:e(l)("common.comStatus"),value:a.value.TimeoutFlag===1?e(l)("common.comNormal"):e(l)("common.comInterrupt"),iconType:a.value.TimeoutFlag===1?e(u).comNormal:e(u).comInterrupt},null,8,["label","value","iconType"]),t(n,{class:"w-[33%]",label:"SOC",value:`${e(s).num(a.value.Soc,1)}%`,iconType:e(u).soc},null,8,["value","iconType"]),t(n,{class:"w-[33%]",label:"SOH",value:`${e(s).num(a.value.Soh,1)}%`,iconType:e(u).soh},null,8,["value","iconType"])]),o("div",Y,[t(n,{class:"w-[33%]",label:e(l)("stack.chargeableEnergy"),"value-unit":e(s).energyUnit(a.value.ChargingCapacity,{num:2,flag:2}),iconType:e(u).chargeEnergy},null,8,["label","value-unit","iconType"]),t(n,{class:"w-[33%]",label:e(l)("stack.dischargeableEnergy"),"value-unit":e(s).energyUnit(a.value.DischargeCapacity,{num:2,flag:2}),iconType:e(u).dischargeEnergy},null,8,["label","value-unit","iconType"]),t(n,{class:"w-[33%]",label:e(l)("stack.totalPower"),"value-unit":e(s).powerUnit(a.value.GrossPower,{num:1,flag:2}),iconType:e(u).power},null,8,["label","value-unit","iconType"])]),o("div",Z,[o("div",ee,[t(n,{class:"mr-[24px]",label:e(l)("stack.maxVoltage"),value:e(s).num(a.value.MaxCellVolt,3),unit:"V"},null,8,["label","value"]),t(n,{label:e(l)("stack.minVoltage"),value:e(s).num(a.value.MinCellVolt,3),unit:"V"},null,8,["label","value"])]),o("div",ae,[t(n,{class:"mr-[24px]",label:e(l)("stack.maxTemp"),value:e(s).num(a.value.MaxCellTemp,0),unit:"℃"},null,8,["label","value"]),t(n,{label:e(l)("stack.minTemp"),value:e(s).num(a.value.MinCellTemp,0),unit:"℃"},null,8,["label","value"])])]),t(I,{title:e(l)("stack.energyCurve"),"module-name":"stack"},null,8,["title"])]),o("div",le,[o("div",te,[o("div",se,[t(n,{class:"mr-[16px]",label:e(l)("common.voltage"),value:e(s).num(a.value.InsideAddedTotalVolt,1),unit:"V"},null,8,["label","value"]),t(n,{label:e(l)("common.current"),value:e(s).num(a.value.CombinedCurrent,1),unit:"A"},null,8,["label","value"])]),o("div",oe,[t(n,{class:"mr-[16px]",label:e(l)("common.totalChargeEnergy"),"value-unit":e(s).energyUnit(a.value.AccumulatedChargeCapacity,{num:2,flag:2})},null,8,["label","value-unit"]),t(n,{label:e(l)("common.totalDischargeEnergy"),"value-unit":e(s).energyUnit(a.value.CumulativeDischargeCapacity,{num:2,flag:2})},null,8,["label","value-unit"])])]),t(B,{"stack-detail-obj":a.value,class:"svgGroup"},null,8,["stack-detail-obj"])])])],512)}}}),Ne=G(ne,[["__scopeId","data-v-b6424220"]]);export{Ne as default};
