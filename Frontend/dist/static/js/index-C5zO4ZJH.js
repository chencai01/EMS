var C=(x,w,e)=>new Promise((h,c)=>{var p=n=>{try{v(e.next(n))}catch(o){c(o)}},_=n=>{try{v(e.throw(n))}catch(o){c(o)}},v=n=>n.done?h(n.value):Promise.resolve(n.value).then(p,_);v((e=e.apply(x,w)).next())});import{o as b,b as V,j as O,d as Z,k as q,l as D,r as E,m as B,p as G,a as m,q as S,w as i,f as s,e as l,i as I,F as U,g as y,t as d,u as t,s as j,v as z,E as M,n as g,_ as L}from"./index-BSlF4gO8.js";import{P as W}from"./pcs-NJQvBWG2.js";import H from"./index-8dw8MoHK.js";import{_ as J}from"./PCSSettings.vue_vue_type_style_index_0_lang-B-O4CFiM.js";import{u as K}from"./useTimer-DPmIGUt7.js";import{v as u}from"./valueUtil-BReNmlgC.js";import{I as f}from"./index-zPJBks9f.js";import"./WarningsUtil-CTO3mp7U.js";import"./icon-settings-BE6Rst9v.js";import"./icon-power-off-CJaF8cS6.js";import"./icontype-wbc23cyS.js";import"./comInterrupt-Cm5Fxwa_.js";const Q={xmlns:"http://www.w3.org/2000/svg",width:"88",height:"92"},X=O('<defs><linearGradient id="a" x1="50%" x2="50%" y1="42.96%" y2="100%"><stop offset="0%" stop-color="#1E3EA2"></stop><stop offset="100%" stop-color="#1E3EA2" stop-opacity="0"></stop></linearGradient><linearGradient id="b" x1="50%" x2="50%" y1="42.96%" y2="100%"><stop offset="0%" stop-color="#1E3EA2"></stop><stop offset="100%" stop-color="#1E3EA2" stop-opacity="0"></stop></linearGradient></defs><g fill="none" fill-rule="evenodd"><path stroke="url(#a)" d="M68 1.5c.966 0 1.841.392 2.475 1.025A3.5 3.5 0 0 1 71.5 5v85.5h-55V5c0-.966.392-1.841 1.025-2.475A3.5 3.5 0 0 1 20 1.5Z"></path><path stroke="url(#b)" d="M71 1.5c.966 0 1.841.392 2.475 1.025A3.5 3.5 0 0 1 74.5 5v82c0 .966-.392 1.841-1.025 2.475A3.5 3.5 0 0 1 71 90.5H17a3.5 3.5 0 0 1-2.475-1.025A3.5 3.5 0 0 1 13.5 87V5c0-.966.392-1.841 1.025-2.475A3.5 3.5 0 0 1 17 1.5Z"></path><path fill="#1E3EA2" fill-opacity=".2" d="M32.5 86h23a.5.5 0 1 1 0 1h-23a.5.5 0 1 1 0-1"></path><path fill="#1E3EA2" fill-opacity=".1" d="M17 7h54a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1H17a1 1 0 0 1-1-1V8a1 1 0 0 1 1-1"></path><path fill="#1E3EA2" d="M32.5 71h23a.5.5 0 1 1 0 1h-23a.5.5 0 1 1 0-1M32.5 74h23a.5.5 0 1 1 0 1h-23a.5.5 0 1 1 0-1"></path><path fill="#1E3EA2" fill-opacity=".8" d="M32.5 77h23a.5.5 0 1 1 0 1h-23a.5.5 0 1 1 0-1"></path><path fill="#1E3EA2" fill-opacity=".6" d="M32.5 80h23a.5.5 0 1 1 0 1h-23a.5.5 0 1 1 0-1"></path><path fill="#1E3EA2" fill-opacity=".4" d="M32.5 83h23a.5.5 0 1 1 0 1h-23a.5.5 0 1 1 0-1"></path><path stroke="#1E3EA2" d="M55.5 23.5v17h-23v-17zM21.5 46.5v17h-2v-17z"></path><path fill="#1E3EA2" fill-opacity=".1" stroke="#1E3EA2" d="M52.5 26.5v11h-17v-11z"></path><path stroke="#1E3EA2" d="M34 15.5c.414 0 .79.168 1.06.44a1.495 1.495 0 0 1 0 2.121c-.27.271-.646.439-1.06.439s-.79-.168-1.06-.44A1.5 1.5 0 0 1 32.5 17c0-.414.168-.79.44-1.06.27-.272.646-.44 1.06-.44ZM44 15.5c.414 0 .79.168 1.06.44a1.495 1.495 0 0 1 0 2.121c-.27.271-.646.439-1.06.439s-.79-.168-1.06-.44A1.5 1.5 0 0 1 42.5 17c0-.414.168-.79.44-1.06.27-.272.646-.44 1.06-.44ZM44 47.5c.69 0 1.315.28 1.768.732.452.453.732 1.078.732 1.768s-.28 1.315-.732 1.768A2.5 2.5 0 0 1 44 52.5c-.69 0-1.315-.28-1.768-.732A2.5 2.5 0 0 1 41.5 50c0-.69.28-1.315.732-1.768A2.5 2.5 0 0 1 44 47.5Z"></path><path stroke="#1E3EA2" stroke-opacity=".4" d="M44 45.5c1.243 0 2.368.504 3.182 1.318A4.49 4.49 0 0 1 48.5 50a4.49 4.49 0 0 1-1.318 3.182A4.49 4.49 0 0 1 44 54.5a4.49 4.49 0 0 1-3.182-1.318A4.49 4.49 0 0 1 39.5 50c0-1.243.504-2.368 1.318-3.182A4.49 4.49 0 0 1 44 45.5Z"></path><path stroke="#1E3EA2" d="M54 15.5c.414 0 .79.168 1.06.44a1.495 1.495 0 0 1 0 2.121c-.27.271-.646.439-1.06.439s-.79-.168-1.06-.44A1.5 1.5 0 0 1 52.5 17c0-.414.168-.79.44-1.06.27-.272.646-.44 1.06-.44Z"></path></g>',2),Y=[X];function tt(x,w){return b(),V("svg",Q,[...Y])}const et={render:tt},at={class:"page-container"},ot={class:"grid-container"},st=["onClick"],lt={class:"grid-item-header"},rt={class:"inline-block"},nt={class:"flex flex-1 w-full"},it={class:"flex flex-col flex-[168] justify-end items-center pb-[71px] min-w-[168px] h-full"},ct={class:"grid-item-content"},dt={class:"flex justify-between w-full"},ut={class:"flex justify-between w-full mt-[16px]"},pt={class:"flex items-center w-full mt-[16px] mb-[44px]"},mt={class:"grid-item-communication-container"},ft={class:"dialog-footer"},_t=Z({name:"PCSList",__name:"index",setup(x){const w=q(),{t:e}=D(),h=E([]),c=E(!1),p=E(!1),_=B({password:""});G(()=>c.value,()=>{});const v=()=>{j({username:z().username,password:_.password}).then(o=>{+o.code==200?(p.value=!1,c.value=!0):M.error(e("pcs.confirmError"))}).catch(o=>{M.error(e("pcs.confirmError"))})},n=()=>C(this,null,function*(){if(!c.value)try{const o=yield W.requestAllPCSList();(o==null?void 0:o.code)==200?JSON.stringify(o.data)!=JSON.stringify(h.value)&&(h.value=o.data.pcsCard):console.warn("--[pcs] request invalid code",o==null?void 0:o.code)}catch(o){console.warn("--[pcs] request error",o==null?void 0:o.message)}});return K(()=>n(),{immediate:!0,immediateCallback:!0}),(o,r)=>{const P=m("el-col"),R=m("el-row"),T=m("el-input"),$=m("el-form-item"),F=m("el-form"),k=m("el-button"),N=m("el-dialog");return b(),S(H,{"active-name":"pcs",onOnSettingClick:r[4]||(r[4]=a=>p.value=!0)},{default:i(()=>[s("div",at,[s("div",ot,[l(R,{type:"flex",class:"flex-wrap",gutter:16},{default:i(()=>[(b(!0),V(U,null,I(h.value,(a,A)=>(b(),S(P,{key:A,class:"grid-item-container",xs:12,sm:12,md:12,lg:12,xl:12},{default:i(()=>[s("div",{class:g(["grid-item cursor-pointer",{comOff:!a.TimeoutFlag},{comOn:a.TimeoutFlag}]),onClick:ht=>t(w).push({path:"/deviceControl/pcs/detail",query:{cabinet:1,pcs:A+1}})},[s("div",lt,[s("span",{class:g(["grid-item-header-status-normal",{"grid-item-header-status-warning":a.fault_status==1},{"grid-item-header-status-fault":a.fault_status==2}])},d(a.fault_status==0?t(e)("common.normal"):a.fault_status==1?t(e)("common.warning"):t(e)("common.fault")),3),s("div",rt,[y(d(t(e)("pcs.itemTitle",{cabinet:1,pcs:A+1}))+" ",1),s("span",null," （"+d(a.DC_status==0?t(e)("common.standby"):a.DC_status==1?t(e)("battery.charging"):t(e)("battery.discharging"))+"） ",1)]),s("span",{class:g(["grid-item-header-state-normal mr-[8px]",[{"grid-item-header-state-fault":a.grid_status==2}]])},d(a.grid_status==2?t(e)("pcs.offGridConnected"):t(e)("pcs.gridConnected")),3),s("span",{class:g(["grid-item-header-state-normal mr-[24px]",[{"grid-item-header-state-stop":a.onoff_status==0}]])},d(a.onoff_status==0?t(e)("pcs.stop"):t(e)("pcs.start")),3)]),s("div",nt,[s("div",it,[l(t(et),{class:"w-[88px] h-[92px]"})]),s("div",ct,[s("div",dt,[l(f,{class:"flex-1",label:t(e)("battery.acActivePower"),"value-unit":t(u).kWShortRoundString(a.total_active_power_of_AC_bus,1)},null,8,["label","value-unit"]),l(f,{class:"flex-1",label:t(e)("battery.acReactivePower"),"value-unit":t(u).kvarShortRoundString(a.total_reactive_power_of_AC_bus,1)},null,8,["label","value-unit"]),l(f,{class:"flex-1",label:t(e)("battery.dcPower"),"value-unit":t(u).kWShortRoundString(a.DC_power,1)},null,8,["label","value-unit"])]),s("div",ut,[l(f,{class:"flex-1",label:"SOC",value:t(u).isValid(a.soc)?t(u).roundString(a.soc,1)+"%":"--"},null,8,["value"]),l(f,{class:"flex-[2]",label:t(e)("battery.moduleTemperature"),value:t(u).roundString(a.module_temperature,1),unit:"℃"},null,8,["label","value"])]),s("div",pt,[l(f,{class:"flex-1",label:t(e)("battery.maximumRechargeablePower"),"value-unit":t(u).kWShortRoundString(a.max_chargeable_power,1)},null,8,["label","value-unit"]),l(f,{class:"flex-[2]",label:t(e)("battery.maximumDischargePower"),"value-unit":t(u).kWShortRoundString(a.max_dischargeable_power,1)},null,8,["label","value-unit"])])])]),s("div",mt,[s("div",{class:g(["grid-item-communication-status-normal",{" grid-item-communication-status-fault":!a.TimeoutFlag}])},d(t(e)(a.TimeoutFlag?"cluster.communicationNormal":"cluster.communicationBreak")),3)])],10,st)]),_:2},1024))),128))]),_:1})]),l(J,{modelValue:c.value,"onUpdate:modelValue":r[0]||(r[0]=a=>c.value=a)},null,8,["modelValue"]),l(N,{modelValue:p.value,"onUpdate:modelValue":r[3]||(r[3]=a=>p.value=a),title:t(e)("pcs.confirmTitle"),width:"400"},{footer:i(()=>[s("span",ft,[l(k,{onClick:r[2]||(r[2]=a=>p.value=!1)},{default:i(()=>[y(d(t(e)("pcs.cancel")),1)]),_:1}),l(k,{type:"primary",onClick:v},{default:i(()=>[y(d(t(e)("pcs.confirm")),1)]),_:1})])]),default:i(()=>[l(F,{model:_},{default:i(()=>[l($,{label:t(e)("login.password"),"label-width":"20%"},{default:i(()=>[l(T,{modelValue:_.password,"onUpdate:modelValue":r[1]||(r[1]=a=>_.password=a),autocomplete:"off",type:"password",placeholder:t(e)("login.passwordReg"),"show-password":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])]),_:1})}}}),Pt=L(_t,[["__scopeId","data-v-75723056"]]);export{Pt as default};
