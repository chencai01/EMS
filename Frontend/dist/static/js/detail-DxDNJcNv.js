var L=(v,l,m)=>new Promise((a,C)=>{var A=_=>{try{b(m.next(_))}catch(p){C(p)}},x=_=>{try{b(m.throw(_))}catch(p){C(p)}},b=_=>_.done?a(_.value):Promise.resolve(_.value).then(A,x);b((m=m.apply(v,l)).next())});import{I as n}from"./index-zPJBks9f.js";import{B as z}from"./index-VJwgctFB.js";import{A as q}from"./index-C6zNsr4v.js";import{d as O,l as $,r as P,k as E,x as H,c as T,v as J,a as D,o as f,b as y,e as t,u as e,f as s,w as i,y as I,t as w,z as U,F as G,i as K,n as j,q as M,A as Q,B as X,C as Y,_ as Z}from"./index-BSlF4gO8.js";import{I as r}from"./icontype-wbc23cyS.js";import{I as ee}from"./icon-warn-Cj0GEASQ.js";import{I as le}from"./icon-error-Cub074DQ.js";import{u as te}from"./useTimer-DPmIGUt7.js";import{v as o}from"./valueUtil-BReNmlgC.js";import{D as ae}from"./index-Btrfdz_5.js";import{g as ne,P as oe}from"./pcs-NJQvBWG2.js";import"./index-Ca9jcqXW.js";import"./cluster-JMpJuoxf.js";import"./WarningsUtil-CTO3mp7U.js";import"./pack-C-9XZzM4.js";import"./meter-CmXvhCrg.js";import"./ac-CthUNdyo.js";import"./icon-power-off-CJaF8cS6.js";import"./comInterrupt-Cm5Fxwa_.js";import"./mitt-E5P-NQ8u.js";import"./index.vue_vue_type_script_setup_true_lang-DUsDJS5Q.js";import"./index-Dxk3FQJj.js";import"./hooks-DCJ-OHnd.js";import"./arrow-right-bold-DCPknizU.js";const B=v=>(X("data-v-d4351296"),v=v(),Y(),v),se={class:"detail-container"},ue={class:"detail-content flex"},re={class:"detail-content-left"},ie={class:"detail-content-left-status"},ce={class:"detail-content-left-collapse-content"},_e={class:"detail-content-left-collapse-content-item"},de={class:"detail-content-left-collapse-content"},ve={class:"detail-content-left-collapse-content-item"},be={class:"detail-content-left-collapse-content-item mb-[6px]"},pe={class:"detail-content-left-collapse-content-item mb-[6px]"},fe={class:"detail-content-left-collapse-content-item mb-[6px]"},me=B(()=>s("div",{class:"line-horizontal"},null,-1)),ge={key:0,class:"detail-content-left-chart"},he={class:"detail-content-left-collapse-content"},ye={class:"detail-content-left-collapse-content-item"},Ce={class:"detail-content-left-collapse-content"},Se={class:"detail-content-left-collapse-content-item"},we={class:"detail-content-left-collapse-content"},Ae={class:"detail-content-left-collapse-content-item"},xe={class:"detail-content-left-collapse-content-item"},Pe={class:"detail-content-right-message"},Be={class:"detail-content-right-message-panel"},ke={class:"detail-content-right-message-panel-warning-title"},Le=B(()=>s("span",null,"(",-1)),Te=B(()=>s("span",null,")",-1)),De={key:0,class:"detail-content-right-message-panel-warning-empty"},Ie={class:"detail-content-right-message-panel-warning-scroll-container"},Re=O({name:"PCSDetail",__name:"detail",setup(v){const{t:l,te:m}=$(),a=P({}),C=E(),A=H(),x=P("1"),b=P("");T(()=>{var u;return(u=J())==null?void 0:u.isAdmin()});const{cabinet:_,pcs:p}=A.query,R={label:o.stringToNumber(_),value:o.stringToNumber(_)},N={label:o.stringToNumber(p),value:o.stringToNumber(p)},W=({cabinet:u,pcs:c})=>{},S=T(()=>ne(a.value)),V=()=>L(this,null,function*(){try{const u=yield oe.requestPCSDetail(1);(u==null?void 0:u.code)==200?JSON.stringify(u.data)!=JSON.stringify(a.value)&&(a.value=u.data):console.warn("--[pcs detail] requestClusterDetail invalid code",u==null?void 0:u.code)}catch(u){console.warn("--[pcs detail] requestClusterDetail error=",u==null?void 0:u.message)}});return te(()=>{V()},{immediate:!0,immediateCallback:!0}),(u,c)=>{const g=D("el-collapse-item"),h=D("el-collapse");return f(),y("div",se,[t(z,{"default-cabinet":R,"default-pcs":N,"default-stack":!1,"default-cluster":!1,"default-pack":!1,onOnChange:W,onOnBackClicked:c[0]||(c[0]=d=>e(C).push("/deviceControl/pcs"))}),s("div",ue,[s("div",re,[s("div",ie,[t(n,{class:"flex-[128] w-0",label:e(l)("common.faultStatus"),value:a.value.fault_status==0?e(l)("common.normal"):a.value.fault_status==1?e(l)("common.warning"):e(l)("common.fault"),iconType:a.value.fault_status==0?e(r).noFault:a.value.fault_status==1?e(r).warning:e(r).fault},null,8,["label","value","iconType"]),t(n,{class:"flex-[128] w-0",label:e(l)("pcs.settings.gridOffConnectedStatus"),value:a.value.grid_status==2?e(l)("pcs.offGridConnected"):e(l)("pcs.gridConnected"),iconType:a.value.grid_status==2?e(r).gridOffConnected:e(r).gridConnected},null,8,["label","value","iconType"]),t(n,{class:"flex-[128] w-0",label:e(l)("pcs.startStopStatus"),value:a.value.onoff_status==0?e(l)("pcs.stop"):e(l)("pcs.start"),iconType:a.value.onoff_status==0?e(r).shutdown:e(r).start},null,8,["label","value","iconType"]),t(n,{class:"flex-[128] w-0",label:e(l)("common.workStatus"),value:a.value.DC_status==0?e(l)("common.standby"):a.value.DC_status==1?e(l)("battery.charging"):e(l)("battery.discharging"),iconType:a.value.DC_status==0?e(r).standby:a.value.DC_status==1?e(r).charging:e(r).disCharging},null,8,["label","value","iconType"]),t(n,{class:"flex-[128] w-0",label:e(l)("common.comStatus"),value:a.value.online_flag==0?e(l)("cluster.communicationBreak"):e(l)("cluster.communicationNormal"),iconType:a.value.online_flag==0?e(r).comInterrupt:e(r).comNormal},null,8,["label","value","iconType"])]),t(h,{class:"detail-content-left-collapse",accordion:!1,"model-value":x.value,onChange:c[1]||(c[1]=d=>{})},{default:i(()=>[t(g,{name:"1"},{title:i(()=>[t(n,{label:e(l)("home.temp"),"label-style":{fontWeight:600,fontSize:"14px",color:"#333333"},value:"","enable-row":!0,"icon-type":e(r).systemTempDifference},null,8,["label","icon-type"])]),default:i(()=>[s("div",ce,[s("div",_e,[t(n,{class:"flex-1",label:e(l)("battery.moduleTemperature"),value:e(o).roundString(a.value.module_temperature,0),unit:"℃"},null,8,["label","value"]),t(n,{class:"flex-[3]",label:e(l)("battery.environmentTemperature"),value:e(o).roundString(a.value.ambient_temperature,0),unit:"℃"},null,8,["label","value"])])])]),_:1})]),_:1},8,["model-value"]),t(h,{class:"detail-content-left-collapse",accordion:!1,onChange:c[2]||(c[2]=d=>{b.value="1"})},{default:i(()=>[t(g,{name:"1"},{title:i(()=>[t(n,{label:e(l)("common.power"),"label-style":{fontWeight:600,fontSize:"14px",color:"#333333"},value:"","enable-row":!0,"icon-type":e(r).powerClear},null,8,["label","icon-type"])]),default:i(()=>[s("div",de,[s("div",ve,[t(n,{class:"flex-1",label:e(l)("battery.acBusTotalPowerFactor"),value:e(o).roundString(a.value.total_PF_of_AC_bus,2)},null,8,["label","value"]),t(n,{class:"flex-1",label:e(l)("battery.acBusAPhasePowerFactor"),value:e(o).roundString(a.value.L1_PF_of_AC_bus,2)},null,8,["label","value"]),t(n,{class:"flex-1",label:e(l)("battery.acBusBPhasePowerFactor"),value:e(o).roundString(a.value.L2_PF_of_AC_bus,2)},null,8,["label","value"]),t(n,{class:"flex-1",label:e(l)("battery.acBusCPhasePowerFactor"),value:e(o).roundString(a.value.L3_PF_of_AC_bus,2)},null,8,["label","value"])]),s("div",be,[t(n,{class:"flex-1",label:e(l)("battery.acBusTotalActivePower"),"value-unit":e(o).kWhShortRoundString(a.value.total_active_power_of_AC_bus,1)},null,8,["label","value-unit"]),t(n,{class:"flex-1",label:e(l)("battery.acBusAPhaseActivePower"),"value-unit":e(o).kWhShortRoundString(a.value.L1_active_power_of_AC_bus,1)},null,8,["label","value-unit"]),t(n,{class:"flex-1",label:e(l)("battery.acBusBPhaseActivePower"),"value-unit":e(o).kWhShortRoundString(a.value.L2_active_power_of_AC_bus,1)},null,8,["label","value-unit"]),t(n,{class:"flex-1",label:e(l)("battery.acBusCPhaseActivePower"),"value-unit":e(o).kWhShortRoundString(a.value.L3_active_power_of_AC_bus,1)},null,8,["label","value-unit"])]),s("div",pe,[t(n,{class:"flex-1",label:e(l)("battery.acBusTotalReactivePower"),"value-unit":e(o).kvarShortRoundString(a.value.total_reactive_power_of_AC_bus,1)},null,8,["label","value-unit"]),t(n,{class:"flex-1",label:e(l)("battery.acBusAPhaseReactivePower"),"value-unit":e(o).kvarShortRoundString(a.value.L1_reactive_power_of_AC_bus,1)},null,8,["label","value-unit"]),t(n,{class:"flex-1",label:e(l)("battery.acBusBPhaseReactivePower"),"value-unit":e(o).kvarShortRoundString(a.value.L2_reactive_power_of_AC_bus,1)},null,8,["label","value-unit"]),t(n,{class:"flex-1",label:e(l)("battery.acBusCPhaseReactivePower"),"value-unit":e(o).kvarShortRoundString(a.value.L3_reactive_power_of_AC_bus,1)},null,8,["label","value-unit"])]),s("div",fe,[t(n,{class:"flex-1",label:e(l)("battery.acBusTotalApparentPower"),"value-unit":e(o).kVAShortRoundString(a.value.total_apparent_power_of_AC_bus,1)},null,8,["label","value-unit"]),t(n,{class:"flex-1",label:e(l)("battery.acBusAPhaseApparentPower"),"value-unit":e(o).kVAShortRoundString(a.value.L1_apparent_power_of_AC_bus,1)},null,8,["label","value-unit"]),t(n,{class:"flex-1",label:e(l)("battery.acBusBPhaseApparentPower"),"value-unit":e(o).kVAShortRoundString(a.value.L2_apparent_power_of_AC_bus,1)},null,8,["label","value-unit"]),t(n,{class:"flex-1",label:e(l)("battery.acBusCPhaseApparentPower"),"value-unit":e(o).kVAShortRoundString(a.value.L3_apparent_power_of_AC_bus,1)},null,8,["label","value-unit"])]),me,b.value.length?(f(),y("div",ge,[t(ae,{isRowLayout:!0,title:e(l)("home.powerCurve"),"module-name":"pcs"},null,8,["title"])])):I("",!0)])]),_:1})]),_:1}),t(h,{class:"detail-content-left-collapse",accordion:!1,onChange:c[3]||(c[3]=d=>{})},{default:i(()=>[t(g,{name:"1"},{title:i(()=>[t(n,{label:e(l)("battery.dischargeChargeAmount"),"label-style":{fontWeight:600,fontSize:"14px",color:"#333333"},value:"","enable-row":!0,"icon-type":e(r).dischargeChargeAmount},null,8,["label","icon-type"])]),default:i(()=>[s("div",he,[s("div",ye,[t(n,{class:"flex-1",label:e(l)("battery.totalACDischarge"),"value-unit":e(o).kWhShortRoundString(a.value.accumulative_dsg_energy_of_AC_port,1)},null,8,["label","value-unit"]),t(n,{class:"flex-1",label:e(l)("battery.totalACCharge"),"value-unit":e(o).kWhShortRoundString(a.value.accumulative_chg_energy_of_AC_port,1)},null,8,["label","value-unit"]),t(n,{class:"flex-1",label:e(l)("battery.currentDayACDischarge"),"value-unit":e(o).kWhShortRoundString(a.value.daily_dsg_energy_of_AC_port,1)},null,8,["label","value-unit"]),t(n,{class:"flex-1",label:e(l)("battery.currentDayACCharge"),"value-unit":e(o).kWhShortRoundString(a.value.daily_chg_energy_of_AC_port,1)},null,8,["label","value-unit"])])])]),_:1})]),_:1}),t(h,{class:"detail-content-left-collapse",accordion:!1,onChange:c[4]||(c[4]=d=>{})},{default:i(()=>[t(g,{name:"1"},{title:i(()=>[t(n,{label:e(l)("battery.directCurrentInfo"),"label-style":{fontWeight:600,fontSize:"14px",color:"#333333"},value:"","enable-row":!0,"icon-type":e(r).batteryInfo},null,8,["label","icon-type"])]),default:i(()=>[s("div",Ce,[s("div",Se,[t(n,{class:"flex-1",label:e(l)("battery.dcPower"),"value-unit":e(o).kWShortRoundString(a.value.DC_power,1)},null,8,["label","value-unit"]),t(n,{class:"flex-1",label:e(l)("battery.dcCurrent"),value:e(o).roundString(a.value.DC_current,1),unit:"A"},null,8,["label","value"]),t(n,{class:"flex-[2]",label:e(l)("battery.dcInputVolt"),value:e(o).roundString(a.value.DC_input_voltage,1),unit:"V"},null,8,["label","value"])])])]),_:1})]),_:1}),t(h,{class:"detail-content-left-collapse",accordion:!1,onChange:c[5]||(c[5]=d=>{})},{default:i(()=>[t(g,{name:"1"},{title:i(()=>[t(n,{label:e(l)("battery.otherInfo"),"label-style":{fontWeight:600,fontSize:"14px",color:"#333333"},value:"","enable-row":!0,"icon-type":e(r).otherInfo},null,8,["label","icon-type"])]),default:i(()=>[s("div",we,[s("div",Ae,[t(n,{class:"flex-1",label:e(l)("battery.acBusPhaseACurrent"),value:e(o).roundString(a.value.L1_current_of_AC_bus,1),unit:"A"},null,8,["label","value"]),t(n,{class:"flex-1",label:e(l)("battery.acBusPhaseBCurrent"),value:e(o).roundString(a.value.L2_current_of_AC_bus,1),unit:"A"},null,8,["label","value"]),t(n,{class:"flex-1",label:e(l)("battery.acBusPhaseCCurrent"),value:e(o).roundString(a.value.L3_current_of_AC_bus,1),unit:"A"},null,8,["label","value"]),t(n,{class:"flex-1",label:e(l)("battery.acBusFrequency"),value:e(o).roundString(a.value.AC_bus_frequence,2),unit:"Hz"},null,8,["label","value"])]),s("div",xe,[t(n,{class:"flex-1",label:e(l)("battery.acBusABVolt"),value:e(o).roundString(a.value.L1L2_voltage_of_AC_bus,1),unit:"V"},null,8,["label","value"]),t(n,{class:"flex-1",label:e(l)("battery.acBusBCVolt"),value:e(o).roundString(a.value.L2L3_voltage_of_AC_bus,1),unit:"V"},null,8,["label","value"]),t(n,{class:"flex-[2]",label:e(l)("battery.acBusCAVolt"),value:e(o).roundString(a.value.L3L1_voltage_of_AC_bus,1),unit:"V"},null,8,["label","value"])])])]),_:1})]),_:1}),t(q,{"module-name":"pcs",data:a.value},null,8,["data"])]),s("div",Pe,[s("div",Be,[s("div",ke,[s("span",null,w(e(l)("pcs.pcsWarnings")),1),Le,s("span",{style:U({color:S.value.length?"#e01f00":"#86909C"})},w(S.value.length),5),Te]),S.value.length?I("",!0):(f(),y("div",De,w(e(l)("cluster.detail.noWarnings")),1)),s("div",Ie,[(f(!0),y(G,null,K(S.value,(d,F)=>{var k;return f(),y("div",{key:F,class:j(d.showType=="warn"?"detail-content-right-message-panel-warning-item-warn":"detail-content-right-message-panel-warning-item-error")},[(f(),M(Q(d.showType=="warn"?e(ee):e(le)),{width:"12px",height:"12px",class:"mt-[6px] ml-[8px]"})),s("span",null,w(e(l)(d.i18n1Key,(k=d.extra)==null?void 0:k.i18n1Options)),1)],2)}),128))])])])])])}}}),ol=Z(Re,[["__scopeId","data-v-d4351296"]]);export{ol as default};
